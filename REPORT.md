Отчет по тестовому заданию
===

## Предварительная подготовка

1. Обновлено Docker окружение для запуска проекта. Есть куча наработок, поэтому не сложно было добавить.
1. Добавлены простые HTTP запросы в папке `tests` для первичного ~~(хоть какого-то)~~ тестирования запросов.
1. Изолировал всё, что связано с `Loyalty` в отдельный модуль и раскидал по слоям. Старые классы не трогал (только дополнял).
1. Добавлена автозагрузка ресурсов для модулей.

## Реализация задачи

### 1. Предметная область

Проделанная работа:
1. Все основные сущности типа `Loyalty` описаны в `Domain` и покрыты в `Infrastructure`.
1. Все объекты в `Domain` полностью изолированы от фреймворка, т.е не используют классы `Illuminate`.
   По сути, фреймворк _задействован_ только в сетевом и инфраструктурных слоях.

### 2. Сетевой слой

Проделанная работа:
1. Все запросы (данные) валидируются и преобразуются в DTO объекты с префиксом `Nwk`,
   которые, в свою очередь, преобразуются и/или передаются дальше. Таким образом, образовалась _двойная защита_ от некорректных данных (на входе).
1. Убрано избыточное логирование, точнее оставил только базовое логирование запросов в родительском контроллере `BaseApiController`.
   Все логи с операциями над сущностями перенесены в другие слои.

Хотелось бы изменить:
1. Мне не сильно нравится наличие базового контроллера `BaseApiController`.
   Хотелось бы от него отказаться, т.к это неизбежное станет узким местом в будущем.
1. В каждом контроллере метод `processRequest` по сути дела является `Action`,
   который тоже можно вынести в отдельный класс. Сходу не понял как это сделать красиво.
1. Было бы не плохо вынести сериализацию/маппинг в отдельный `middleware`, но я пока не до конца в этом разобрался.
1. Не до конца освоил валидацию с точки зрения изоляции в отдельном объекте.
   Все примеры в интернете убогие.

### 3. Бизнес логика и сценарии

Проделанная работа:
1. Для каждого контроллера создан отдельный сервис-сценарий `UseCase`, который его обрабатывает.
1. Каждый сервис-сценарий является оберткой над другими сервисами, которые выполняют более мелкие (атомарные) операции.
   Тем самым он контролирует их поведение (результат).

### 4. Инфраструктура

1. Инфраструктура поделена на дополнительные подпространства, каждый из которых отвечает за работу с разными источниками данных или службами.
1. Не углублялся в работу и корректность статических методов у сущностей.
   В домене они не описаны, поэтому их можно в любой момент подкорректировать.
